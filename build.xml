<project name="tritonus" default="dist" basedir=".">
	<target name="init">
		<tstamp/>
		<property name="src" value="src" />
		<property name="build" value="build" />
		<property name="dist"  value="dist" />
		<filter token="version" value="0.3.1" />
		<filter token="year" value="2000" />
<!--
		<ant dir="../javalayer" />
-->
		<available
			classname="grame.midishare.Midi"
			property="midishare-present" />
		<available
			classname="javazoom.jl.decoder.Decoder"
			property="javalayer-present" />
		<property
			name="java_ext_path"
			value="${java.home}/lib/ext" />
	</target>

	<target name="prepare" depends="init">
		<mkdir dir="${build}" />
	</target>

	<target name="compile" depends="prepare">
		<javac srcdir="src"
			destdir="${build}"
			includes="javax/sound/**,org/tritonus/**"
			excludes="org/tritonus/midi/device/midishare/**,org/tritonus/midi/old/**"
			filtering="on"/>
	</target>

	<target name="compile-midishare"
		depends="prepare"
		if="midishare-present">
		<javac srcdir="src"
			destdir="${build}"
			includes="org/tritonus/midi/device/midishare/**"
			filtering="on"/>
	</target>

	<target name="dist"
		depends="compile,compile-midishare">
		<mkdir dir="${dist}" />
		<jar jarfile="${dist}/tritonus_core.jar"
			basedir="${build}"
			includes="javax/sound/,org/tritonus/core/" />
		<copydir src="${build}" dest="${dist}/tritonus_core"
			includes="javax/sound/**" />
		<copydir src="${src}/packaging/tritonus_core" dest="${dist}/tritonus_core"
			includes="**" />
		<jar jarfile="${dist}/tritonus_share.jar"
			basedir="${build}"
			includes="javax/sound/**,org/tritonus/**"/>
		<copydir src="${build}" dest="${dist}/tritonus_core"
			includes="javax/sound/**" />
		<copydir
			src="${src}/packaging/tritonus_core"
			dest="${dist}/tritonus_core"
			includes="**" />
		<mkdir dir="${dist}/tritonus_mixer_esd" />
		<jar
			jarfile="${dist}/tritonus_mixer_esd.jar"
			basedir="${build}"
			includes="org/tritonus/lowlevel/esd/**,org/tritonus/sampled/mixer/esd/**" />
	</target>

	<target name="clean" depends="init">
		<deltree dir="${build}" />
		<deltree dir="${dist}" />
	</target>
</project>
